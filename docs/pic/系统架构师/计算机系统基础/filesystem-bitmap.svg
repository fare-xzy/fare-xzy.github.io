<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550">
  <!-- Definitions -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333" />
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <style>
      .title { font-size: 24px; font-weight: bold; fill: #1565C0; font-family: 'Microsoft YaHei', sans-serif; }
      .subtitle { font-size: 18px; font-weight: bold; fill: #455A64; font-family: 'Microsoft YaHei', sans-serif; }
      .label { font-size: 14px; fill: #546E7A; font-family: sans-serif; }
      .small-label { font-size: 12px; fill: #78909C; font-family: sans-serif; }
      .cell-text { font-size: 12px; fill: #333; font-family: monospace; text-anchor: middle; dominant-baseline: middle; }
      .block-text { font-size: 14px; fill: #333; font-weight: bold; font-family: sans-serif; text-anchor: middle; dominant-baseline: middle; }
      .formula { font-size: 16px; fill: #C62828; font-weight: bold; font-family: monospace; }
      .note { font-size: 14px; fill: #333; font-family: sans-serif; }
      
      /* Status Colors */
      .free { fill: #C8E6C9; stroke: #81C784; } /* Green */
      .busy { fill: #FFCDD2; stroke: #E57373; } /* Red */
      .highlight { fill: #FFF9C4; stroke: #FBC02D; stroke-width: 2; } /* Yellow highlight */
      .connector { stroke: #1976D2; stroke-width: 2; fill: none; stroke-dasharray: 5,5; }
    </style>
  </defs>

  <!-- Main Title -->
  <text x="450" y="40" class="title" text-anchor="middle">图解位示图法 (Bit Map): 从"位"到"块"的映射</text>

  <!-- ================= LEFT SIDE: BIT MAP ================= -->
  <g transform="translate(50, 80)">
    <text x="160" y="-10" class="subtitle" text-anchor="middle">1. 内存中的位示图 (Bit Map)</text>
    <text x="160" y="15" class="label" text-anchor="middle">用 0/1 标记状态 (0=空闲, 1=占用)</text>
    
    <!-- Headers -->
    <text x="-10" y="50" class="label" text-anchor="end">字0 (Word 0)</text>
    <text x="-10" y="90" class="label" text-anchor="end">字1 (Word 1)</text>
    <text x="-10" y="130" class="label" text-anchor="end">字2 (Word 2)</text>
    
    <text x="20" y="35" class="small-label" text-anchor="middle">位0</text>
    <text x="60" y="35" class="small-label" text-anchor="middle">位1</text>
    <text x="100" y="35" class="small-label" text-anchor="middle">位2</text>
    <text x="140" y="35" class="small-label" text-anchor="middle">位3</text>
    <text x="300" y="35" class="small-label" text-anchor="middle">位15</text>

    <!-- Word 0 Row (Mixed) -->
    <rect x="0" y="40" width="40" height="30" class="busy" /><text x="20" y="55" class="cell-text">1</text>
    <rect x="40" y="40" width="40" height="30" class="busy" /><text x="60" y="55" class="cell-text">1</text>
    <rect x="80" y="40" width="40" height="30" class="free" /><text x="100" y="55" class="cell-text">0</text>
    <rect x="120" y="40" width="40" height="30" class="busy" /><text x="140" y="55" class="cell-text">1</text>
    <rect x="160" y="40" width="120" height="30" fill="#f5f5f5" stroke="#ddd" /> <text x="220" y="55" class="cell-text">...</text>
    <rect x="280" y="40" width="40" height="30" class="free" /><text x="300" y="55" class="cell-text">0</text>

    <!-- Word 1 Row (Highlight Target) -->
    <rect x="0" y="80" width="40" height="30" class="busy" /><text x="20" y="95" class="cell-text">1</text>
    <rect x="40" y="80" width="40" height="30" class="free" /><text x="60" y="95" class="cell-text">0</text>
    
    <!-- The Highlighted Bit: Word 1, Bit 2 -->
    <rect x="80" y="80" width="40" height="30" class="highlight" filter="url(#shadow)" />
    <text x="100" y="95" class="cell-text" font-weight="bold">1</text>
    
    <rect x="120" y="80" width="40" height="30" class="free" /><text x="140" y="95" class="cell-text">0</text>
    <rect x="160" y="80" width="120" height="30" fill="#f5f5f5" stroke="#ddd" /> <text x="220" y="95" class="cell-text">...</text>
    <rect x="280" y="80" width="40" height="30" class="busy" /><text x="300" y="95" class="cell-text">1</text>

    <!-- Word 2 Row -->
    <rect x="0" y="120" width="40" height="30" class="free" /><text x="20" y="135" class="cell-text">0</text>
    <rect x="40" y="120" width="40" height="30" class="free" /><text x="60" y="135" class="cell-text">0</text>
    <rect x="80" y="120" width="40" height="30" class="free" /><text x="100" y="135" class="cell-text">0</text>
    <rect x="120" y="120" width="200" height="30" fill="#f5f5f5" stroke="#ddd" /> <text x="220" y="135" class="cell-text">...</text>

    <!-- Callout for Word/Bit -->
    <path d="M70 95 L-40 95 L-40 180" stroke="#546E7A" stroke-width="1.5" fill="none" />
    <text x="-35" y="195" class="label" fill="#C62828">字号 n = 1</text>
    
    <path d="M100 80 L100 20 L130 10" stroke="#546E7A" stroke-width="1.5" fill="none" />
    <text x="135" y="15" class="label" fill="#C62828">位号 j = 2</text>
  </g>

  <!-- ================= CENTER: CALCULATION ================= -->
  <g transform="translate(380, 200)">
    <rect x="-10" y="-20" width="160" height="100" rx="10" fill="#FFF3E0" stroke="#FFB74D" />
    <text x="70" y="0" class="label" text-anchor="middle" font-weight="bold">地址转换公式</text>
    <line x1="10" y1="10" x2="130" y2="10" stroke="#FFB74D" />
    <text x="70" y="30" class="formula" font-size="14" text-anchor="middle">b = n × w + j</text>
    <text x="70" y="55" class="note" font-size="12" text-anchor="middle">w = 字长 (16位)</text>
    <text x="70" y="75" class="formula" text-anchor="middle">1×16 + 2 = 18</text>
  </g>

  <!-- ================= RIGHT SIDE: DISK BLOCKS ================= -->
  <g transform="translate(550, 80)">
    <text x="150" y="-10" class="subtitle" text-anchor="middle">2. 磁盘物理块 (Disk Blocks)</text>
    <text x="150" y="15" class="label" text-anchor="middle">实际的数据存储空间</text>

    <!-- Block Grid Layout corresponding to Words -->
    
    <!-- Row 0 (Blocks 0-15) -->
    <text x="-40" y="50" class="label" text-anchor="end">对应字0</text>
    <g>
        <rect x="0" y="40" width="300" height="30" fill="#f5f5f5" stroke="#ddd" />
        <rect x="0" y="40" width="30" height="30" class="busy" /><text x="15" y="55" class="cell-text">0</text>
        <rect x="30" y="40" width="30" height="30" class="busy" /><text x="45" y="55" class="cell-text">1</text>
        <rect x="60" y="40" width="30" height="30" class="free" /><text x="75" y="55" class="cell-text">2</text>
        <rect x="90" y="40" width="30" height="30" class="busy" /><text x="105" y="55" class="cell-text">3</text>
        <text x="285" y="55" class="cell-text">15</text>
    </g>

    <!-- Row 1 (Blocks 16-31) -->
    <text x="-40" y="90" class="label" text-anchor="end">对应字1</text>
    <g>
        <rect x="0" y="80" width="300" height="30" fill="#f5f5f5" stroke="#ddd" />
        <rect x="0" y="80" width="30" height="30" class="busy" /><text x="15" y="95" class="cell-text">16</text>
        <rect x="30" y="80" width="30" height="30" class="free" /><text x="45" y="95" class="cell-text">17</text>
        
        <!-- Target Block 18 -->
        <rect x="60" y="80" width="30" height="30" class="highlight" filter="url(#shadow)" />
        <text x="75" y="95" class="block-text">18</text>
        
        <rect x="90" y="80" width="30" height="30" class="free" /><text x="105" y="95" class="cell-text">19</text>
        <rect x="270" y="80" width="30" height="30" class="busy" /><text x="285" y="95" class="cell-text">31</text>
    </g>

    <!-- Row 2 (Blocks 32-47) -->
    <text x="-40" y="130" class="label" text-anchor="end">对应字2</text>
    <g>
        <rect x="0" y="120" width="300" height="30" fill="#f5f5f5" stroke="#ddd" />
        <rect x="0" y="120" width="30" height="30" class="free" /><text x="15" y="135" class="cell-text">32</text>
        <text x="285" y="135" class="cell-text">47</text>
    </g>
  </g>

  <!-- ================= ARROWS & FLOW ================= -->
  <!-- Arrow from Bit to Calculator -->
  <path d="M120 110 Q 200 250 370 250" stroke="#1976D2" stroke-width="2" fill="none" marker-end="url(#arrow)" />
  
  <!-- Arrow from Calculator to Block -->
  <path d="M540 250 Q 625 250 625 125" stroke="#1976D2" stroke-width="2" fill="none" marker-end="url(#arrow)" />

  <!-- Legend -->
  <g transform="translate(350, 450)">
    <rect x="0" y="0" width="200" height="60" fill="#fff" stroke="#999" rx="5" />
    <text x="100" y="20" class="label" text-anchor="middle" font-weight="bold">图例 (Legend)</text>
    
    <rect x="20" y="35" width="20" height="15" class="free" />
    <text x="45" y="47" class="small-label">0: 空闲 (Free)</text>
    
    <rect x="110" y="35" width="20" height="15" class="busy" />
    <text x="135" y="47" class="small-label">1: 占用 (Used)</text>
  </g>

</svg>